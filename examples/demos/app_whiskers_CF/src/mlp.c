#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "CF_whiskers_onboard.h"
#include "mlp.h"
#include "debug.h"
#include "arm_math.h"

void init_mlp_params(MLPParams* params_1, MLPParams* params_2) 
{
    // 为 MLPParams 的每个参数初始化赋值
    if (params_1 == NULL || params_2 == NULL) 
    {
        DEBUG_PRINT("MLP params are NULL!\n");
        return;
    }

    // 初始化 params_1
    const float mean_1[3] = {54.20560548, -21.00775578, -14.01101664};
    const float std_1[3] = {18.14239061, 8.27251843, 11.67656998};
    const float W1_1[HIDDEN_SIZE_1][INPUT_SIZE] = 
    {
    {-0.03988715, -0.90685606,  0.17397702},
    { 0.44534063,  0.17434978, -0.66993129},
    { 0.31861299, -0.58847284,  0.25675106},
    { 0.10706893,  1.05427337,  0.48577157},
    { 0.03235232, -0.61063069,  0.09852455},
    {-0.00401722,  0.74184716, -0.33961269},
    { 0.53357798,  0.37958631, -0.51463902},
    { 0.14494914,  0.06543715,  0.93033314},
    { 0.01377136, -0.63969088,  0.13593104},
    { 0.51605791, -0.73204368,  0.38650134},
    { 0.00372134, -0.85290277,  0.13626273},
    { 0.3368701,   1.09571433, -0.17177701},
    { 0.1649486,  -0.3342019,   0.12811339},
    {-0.05771584,  0.75664306, -0.42084622},
    { 0.54754388, -0.59601086,  0.0363606},
    { 1.07856297,  0.77920896, -0.06711819},
    { 0.35928813, -0.13883205, -0.60379046},
    {-0.17186956, -0.52478552, -0.65555394},
    {-0.27041966,  0.76079816,  0.04840358},
    { 0.49825335,  0.23003221,  0.15736887},
    { 0.55769753,  0.95812935, -0.15842244},
    { 0.16499996, -0.57377958,  0.1488041},
    {-0.33563849, -0.01718801, -0.53255135},
    {-0.01347943, -0.32038584, -0.43082604},
    { 0.64977628, -0.47805923, -0.29765999},
    { 0.54708838,  0.82945561, -0.04255312},
    {-0.04422076,  0.09175441, -0.35573983},
    {-0.51534486,  0.15435447,  0.18686213},
    { 0.3145566,   0.10608505, -0.08965971},
    {-0.2675451,  -0.12160398,  1.14282978},
    {-0.29951808, -0.24087423,  1.04694092},
    { 0.81673634,  0.42181376,  0.49792042}
    };
    const float b1_1[HIDDEN_SIZE_1] = 
    {
    0.34735814, -0.05203633, 0.01531572, 0.27924147, 0.33301243, -0.53045243, -0.06572869, 0.17199802, 0.30729190, 0.02102652, 0.45540723, -0.24691026, 0.37039813, -0.50760978, 0.02703871, -0.07725274, 0.13782521, -0.17805514, 0.24874595, 0.43411523, -0.47396901, 0.07777163, 0.25440818, 0.39955318, -0.23279025, -0.38940972, 0.42001614, -0.78807467, 0.54782987, -0.25065958, -0.26208800, 0.33563104
    };
    const float W2_1[HIDDEN_SIZE_2][HIDDEN_SIZE_1] = 
    {
    {-0.36564189, -0.09318838, -0.00698699, 0.03436757, 0.47034934, -0.01412866, 0.04584989, 0.01434984, 0.10109905, -1.02481079, 0.31564787, 0.15307829, -0.94604754, -0.01829395, -1.42390978, 0.29197833, -0.19479409, -1.07075787, -0.04316255, 0.15333766, 0.60930461, 0.08413347, -0.18023823, -0.41499832, -1.62625575, 0.35526028, -0.07790193, -0.41590342, 0.04530105, -0.73121887, -1.02652979, 0.21019930},
    {0.22608946, -0.09717647, 0.13637519, 0.02771173, 0.01712971, 0.20952132, -0.03013594, 0.09903013, 0.25563672, 0.09610297, 0.04508970, 0.01412782, -0.01230981, 0.10018340, 0.12796830, -0.18540165, 0.01297330, 0.05876575, -0.02989608, -0.01230793, -0.04556753, 0.25073731, -0.08560644, -0.14728616, -0.02342881, -0.10470380, 0.08166869, -0.69661361, -0.04642133, -0.01486584, 0.03260944, 0.07721449},
    {-0.09315149, 0.00062763, 0.08285678, -2.21226001, -0.13451631, -0.44342759, 0.06814419, -0.04008440, -0.08718226, -0.02250699, -0.27796957, -1.88494277, -0.14186750, -0.92704338, 0.16836935, 0.36939570, -0.03539817, 0.09598303, -1.28184593, 0.16788588, -1.62660444, 0.03364703, -0.04827343, 0.19239137, -0.08170657, -0.80055708, -0.01297859, -0.19284001, 0.14424522, 0.23137605, 0.06963498, 0.13976091},
    {0.16205122, -0.02891786, 0.25053963, -0.08386203, 0.01456309, 0.24924004, -0.04379488, -0.05381348, 0.19796373, -0.00989277, 0.09135403, 0.04850618, 0.10293762, 0.07598213, 0.03322078, 0.10105626, 0.03087439, 0.09207653, 0.17641066, -0.05732111, -0.00715459, 0.10098407, -0.11602481, -0.00716034, 0.16602823, 0.19123133, -0.02814882, -0.70235592, -0.03261246, 0.13296157, 0.11110493, -0.11928774},
    {0.19428411, -0.04984002, 0.24493107, -0.06861534, 0.18137471, 0.26384023, 0.15396170, 0.09173988, 0.15930037, 0.07915170, 0.08294980, 0.20366547, 0.03451356, 0.11634082, -0.05106407, 0.05918421, -0.13310449, -0.03149229, 0.08062463, -0.07772470, -0.01423294, 0.01651184, 0.01970227, -0.19281431, 0.20512195, 0.04021406, 0.02479236, -0.60891265, -0.00300034, -0.01621465, 0.02554821, -0.12262855},
    {0.02883154, -0.07830487, 0.20124964, 0.14306356, 0.20343047, 0.11761817, -0.08368604, 0.14913988, 0.20403197, -0.00088317, 0.25518849, 0.11677516, -0.12258597, 0.15203013, -0.05300666, -0.09087744, 0.11842363, 0.08168279, -0.09769191, -0.03064147, -0.11860315, 0.20958786, -0.07737599, -0.05400017, 0.17096929, -0.02338604, -0.01974124, -0.70456302, 0.07991941, 0.01265598, 0.04293599, 0.06625013},
    {0.12231626, 0.10487439, -0.01603659, -0.15814616, 0.25787315, 0.10422436, -0.00111934, 0.01846723, 0.07339649, -0.00446322, 0.04889279, 0.04293045, -0.00890190, -0.03599345, 0.05063843, 0.04663829, -0.08617080, -0.06603782, 0.12191901, 0.09823873, 0.02571474, 0.26938233, -0.02293380, 0.09725142, 0.16659999, 0.10606515, 0.08384632, -0.83767414, -0.12698556, 0.02194553, 0.19023825, 0.02921926},
    {-0.02606581, 0.34489268, -0.03011245, -0.38033012, -0.06265320, -0.21125251, 0.10908194, 0.11810798, 0.08589124, -0.04107292, -0.14514415, -1.09527802, 0.10696308, -0.40652904, 0.12869476, -0.15439016, 0.24589373, -0.15697150, -0.11514760, -0.02610604, -1.28674626, -0.11305178, 0.07643990, 0.09307555, 0.20049594, -1.10326493, 0.07385235, -1.13366604, -0.10409240, 0.25147715, 0.21573806, -0.04329799},
    {-0.09603041, 0.30507320, 0.04700033, -0.27266714, -0.01101312, -0.31206790, 0.25168359, 0.08766210, -0.11915389, 0.04545267, -0.12396134, -1.32459426, -0.02583307, -0.45230740, 0.05310257, 0.00754574, 0.14061654, -0.17051381, -0.11717115, -0.05139063, -1.53580654, -0.08175775, 0.03415134, 0.07938951, 0.14677361, -1.12622690, 0.02324773, -1.22426462, -0.01363861, 0.24332854, 0.18120533, -0.12518911},
    {0.06347758, 0.17427427, 0.21509498, -0.02997679, 0.21098547, 0.19462608, -0.04600620, 0.13922128, 0.14016412, -0.00119280, 0.23530900, 0.03468606, 0.13380787, 0.06055517, 0.17996356, -0.11626854, -0.05199704, 0.07702050, -0.02844373, 0.11836091, -0.01329555, 0.30068973, 0.13642363, -0.02460470, 0.03675159, -0.00915174, 0.14007887, -0.69504905, -0.11910928, 0.08602356, 0.00660379, 0.14265434},
    {0.07163204, 0.02494723, 0.03217217, -0.15060173, 0.21171884, 0.27708495, 0.07577848, 0.23789543, 0.07320978, 0.20957425, 0.09017931, 0.07582401, -0.04827936, 0.18265055, -0.11659226, -0.01793739, 0.11997733, 0.12826027, 0.07142933, 0.10775232, -0.03758260, 0.03038795, 0.10828522, 0.07917080, 0.17263882, -0.05920906, -0.10620891, -0.82218152, -0.13401620, 0.04226656, 0.20616899, 0.12610301},
    {0.17226321, 0.09135700, 0.15127018, -0.08056594, 0.17290284, 0.34900129, -0.10742237, 0.01690770, 0.17469350, 0.07902570, 0.21891972, -0.09516770, 0.16559608, 0.07177035, 0.01805662, 0.10048167, -0.14011635, 0.11633427, -0.03652110, 0.07888341, 0.05558339, 0.01659330, 0.03505039, -0.11257132, 0.03977062, 0.14790742, 0.14444980, -0.66254598, -0.02239420, 0.02034171, 0.13278344, 0.01217035},
    {0.19801299, 0.12486861, 0.21126799, 0.00237889, 0.11137988, 0.08882218, 0.12728660, 0.09615095, 0.01126899, 0.07323986, 0.26269215, -0.01994541, 0.06954449, 0.02845915, 0.10536687, 0.01414163, -0.15256387, -0.09142815, 0.13319615, -0.07053832, -0.10899789, 0.20597489, -0.11197516, -0.04614511, 0.14770836, 0.13308400, 0.02516448, -0.72043025, -0.04654235, 0.09882496, 0.09186445, -0.13794358},
    {-0.14852124, 0.23546611, -0.02452851, -0.33050609, -0.13938101, -0.24795254, 0.22197682, 0.11733049, -0.12926827, 0.06742873, -0.10962947, -1.14010072, 0.11420289, -0.29620159, 0.09386996, -0.03941546, 0.18078694, -0.07281922, -0.16158114, -0.04021893, -1.40875423, -0.00342208, 0.13992028, 0.10437129, 0.10885103, -1.03416479, -0.02608895, -1.23633993, -0.06503335, 0.28162369, 0.22908027, -0.06578718},
    {0.10908879, -1.02254236, 0.15839413, -0.00696731, 0.07529429, 0.11089592, -0.75261831, 0.13538404, 0.10518288, 0.02583322, 0.13465872, 0.11720087, -0.06830958, 0.09905010, 0.32961404, 1.13715887, -0.73187518, -0.08882115, 0.13449115, -0.33530957, 0.30038342, 0.07999504, -0.37215850, -0.30560338, -0.17416702, 0.93749887, -0.46729401, 0.39424402, -0.56576681, 0.32811099, 0.33159095, -0.22121650},
    {0.12651864, -0.12624925, 0.01773489, -0.07890459, 0.17711143, 0.12284424, 0.11402278, 0.13957970, 0.08658002, 0.14571929, 0.27805093, 0.09141831, 0.11966978, 0.07662408, 0.04058573, 0.11372260, 0.05075844, -0.09959213, 0.15167125, 0.04548066, 0.07183531, 0.17226151, -0.17787012, -0.02027736, -0.04658524, -0.00715401, -0.01992838, -0.69024760, -0.06978267, 0.06602474, -0.09632742, -0.12342305},
    {0.01355934, -0.11571185, 0.17738336, 0.00923117, -0.02042382, 0.16137075, -0.01403308, 0.02655462, 0.19750232, 0.08715861, 0.26014498, 0.15294991, 0.14971663, 0.19166607, -0.00719329, 0.11590369, -0.03187977, 0.03046621, -0.03600547, -0.12808895, 0.03079750, 0.17862585, 0.00860129, -0.06355756, 0.11638197, -0.07507551, -0.01742716, -0.65341234, -0.03431569, 0.04655993, 0.03596620, -0.05185962},
    {0.28507820, -0.07416712, 0.16238683, -0.05981585, 0.21052997, 0.13962948, -0.00502692, -0.02793469, 0.31599948, 0.15022001, 0.17076579, 0.11037089, 0.17623341, 0.10155721, 0.03456160, 0.08512516, -0.03399395, 0.12452324, 0.15974699, -0.02601860, -0.06219867, -0.00410007, 0.07322414, -0.06050184, 0.04100494, 0.10062091, 0.10999031, -0.58270037, -0.05222110, 0.17569396, -0.02893080, 0.17719215},
    {0.02250373, -0.01996181, 0.09089591, 0.09571603, 0.14088987, 0.19798887, 0.08809947, 0.03434949, 0.21873948, 0.11376584, 0.33023202, -0.16081318, 0.10745508, 0.22412182, 0.10355196, -0.12610555, 0.12210816, 0.07169122, 0.08115231, 0.04349123, -0.04643444, 0.09646854, -0.05713239, 0.02618788, -0.02336933, -0.06831377, -0.14826521, -0.71145833, -0.01788727, 0.18623163, 0.12064665, 0.04423576},
    {0.23286892, 0.04707687, 0.03270120, 0.10807067, 0.25919807, 0.30704203, 0.07600298, -0.07366172, 0.23495661, 0.23617914, 0.29425454, 0.04487601, 0.10258882, 0.14004835, 0.03890600, 0.00062742, -0.13935930, 0.07672568, 0.08888177, -0.08921203, -0.12624864, 0.08422001, 0.13328469, -0.19222957, 0.08670746, -0.00959033, -0.14266968, -0.62010485, -0.04636892, 0.13498151, 0.12060991, 0.08791437},
    {0.09723742, -0.13495566, -0.00056221, 0.05035048, 0.05442129, 0.03987434, 0.02342432, -0.01683067, 0.14738032, 0.11241376, 0.08840565, 0.02311919, 0.02655981, 0.14618249, 0.01299617, 0.02896622, 0.00470045, 0.09504133, -0.02212794, 0.00340105, -0.21398436, 0.11496358, 0.01851062, -0.16189200, 0.17710106, 0.10494912, 0.06232200, -0.62361974, 0.05603396, -0.00807607, 0.05817851, 0.07059333},
    {0.07656927, -0.00494077, 0.28629479, 0.03591916, 0.23396792, 0.26945031, -0.08203845, 0.02297790, 0.14634110, -0.02567938, 0.28615481, 0.08691309, -0.06112385, 0.22201067, 0.07309269, -0.11495113, -0.04616575, -0.08599465, 0.00092794, -0.07860400, 0.05297069, 0.23576455, -0.01932768, -0.03102954, 0.01889661, 0.09877510, -0.03783038, -0.65600598, 0.02907052, -0.10746305, 0.11073712, 0.05090607},
    {0.09054889, 0.08376742, 0.03902366, 0.09949093, 0.03232253, 0.08764344, 0.13953625, 0.00293853, 0.02656548, 0.00417850, 0.31801692, -0.05492291, 0.10785103, 0.19503532, 0.00913440, -0.01480271, -0.00713110, -0.00315545, 0.00291060, -0.03641352, 0.03682645, 0.16069894, 0.07638133, -0.10961085, 0.02769860, -0.08102607, 0.03655055, -0.71830273, -0.04953685, 0.09768410, -0.01693563, 0.02442659},
    {0.14027268, -0.02515171, 0.18024930, -0.01319547, 0.07486450, 0.25359017, 0.03162478, -0.00726578, 0.13062902, 0.08881927, 0.18193753, 0.10683884, 0.05781394, 0.35877520, 0.11594667, 0.08053210, 0.05388013, 0.11191688, 0.10900754, -0.12896296, -0.04478619, 0.03488098, 0.07815130, -0.06611817, 0.19226868, 0.01237566, -0.05553559, -0.72642279, -0.08833652, 0.15024170, 0.05305914, -0.06195593},
    {-0.02692191, -0.14890321, 0.17168899, 0.16808662, 0.07719101, 0.06173633, 0.07243557, 0.00949876, 0.11911665, 0.20807415, 0.31478861, 0.10199362, 0.16569991, 0.21932745, 0.10198362, 0.05033751, -0.17263979, 0.13738172, -0.07281228, -0.06194887, 0.06499624, 0.21000278, -0.02937224, -0.09993902, 0.14468859, -0.10470259, 0.08333734, -0.67508179, -0.02893951, -0.01698671, 0.03012163, 0.03616976},
    {0.19229679, -0.77049458, -1.25214493, 0.01462803, 0.24293447, 0.35443285, -0.16829352, -1.61476052, 0.24516162, -0.65048110, 0.14897227, 0.21236634, 0.03842651, 0.30835745, -1.26661265, -1.34817219, -0.92847592, 0.06170797, 0.13261861, 0.04188132, -0.74786866, 0.13656059, 0.25268599, 0.19552150, -0.96575177, -1.03007889, 0.29805571, -0.46084100, 0.21441051, -0.88036436, -0.38547939, -0.88011897},
    {0.25285488, 0.08008208, 0.09332342, 0.07651890, 0.24874078, 0.26079482, -0.09411301, 0.01553421, 0.05501319, 0.01267101, 0.09452163, -0.13164729, -0.01072598, 0.18918347, -0.06149936, 0.13083608, 0.09120710, -0.09887210, -0.03573633, -0.06949569, 0.02962128, 0.16565672, 0.06115460, 0.09216881, 0.01547587, -0.00526003, 0.07005994, -0.69039828, 0.16141343, -0.04286321, 0.22378916, 0.08797538},
    {0.10197750, 0.14919896, 0.22928239, 0.09671499, 0.25326282, 0.26882908, -0.07688934, 0.02101354, 0.11572853, -0.02836033, 0.24167892, -0.02062419, 0.16597216, 0.14399040, 0.03499649, -0.02797200, 0.02954893, 0.08084846, 0.11657228, 0.08041812, 0.08904809, 0.18521650, -0.07170279, -0.13977627, 0.19707748, 0.13168262, -0.18658772, -0.66136354, -0.06808649, -0.04162405, 0.08502922, -0.12095365},
    {0.11154901, 0.05826849, 0.18178459, -0.03077155, 0.06746623, 0.21366490, 0.12962510, -0.00895473, 0.11581604, 0.01515511, 0.21126445, 0.08643954, 0.11431882, 0.23896557, -0.04526474, -0.08080538, -0.00464196, -0.00818579, -0.02738345, -0.03085245, -0.04438874, 0.12892216, -0.01371005, -0.10921408, 0.09883231, 0.00499247, 0.06500354, -0.68864310, -0.09155703, 0.02901039, 0.13609102, -0.05599237},
    {0.17456204, 0.01263797, 0.11184932, -0.08664206, 0.09797796, 0.13380225, -0.02976695, 0.16511755, 0.04185159, 0.08968946, 0.07643040, 0.16564012, 0.18128203, 0.03480635, -0.10409933, -0.08207592, 0.04339344, 0.09503185, -0.01134229, 0.12924927, -0.19800355, 0.02990304, 0.06647807, -0.11118007, 0.07448084, 0.05970940, -0.11022462, -0.71858782, 0.14035007, 0.19776008, -0.06314396, 0.00879454},
    {0.09934442, -1.00083899, -0.08681060, -0.19588175, -0.21326397, -0.29320806, -1.14144945, 0.35481399, 0.05645797, -0.14600648, -0.07987700, -0.20705113, -0.26891109, -0.35116696, 0.62468809, 1.45663953, -0.59283751, -0.02143068, 0.12425783, -0.19457674, -0.10190824, -0.19862555, -0.40731603, -0.74405974, -0.37928268, 1.00246906, -0.76549596, 0.71964204, -0.57827765, 0.34083772, 0.31377432, 0.13345790},
    {0.29784197, -0.08478794, 0.07895900, 0.09170061, 0.28789064, 0.28919053, 0.04960252, 0.05489760, 0.05411071, 0.27002263, 0.05023493, -0.04287335, 0.10224872, 0.27539486, 0.06311644, -0.05165877, 0.06501541, 0.08939295, 0.06524203, 0.10353223, -0.03244976, 0.01127775, -0.02822627, -0.06591412, 0.12981538, 0.13990229, 0.04786295, -0.69835997, -0.01943817, 0.02957100, 0.12192273, 0.00068731},
    };
    const float b2_1[HIDDEN_SIZE_2] = 
    {
    0.10783314, 0.55336696, 0.45367095, 0.52924871, 0.52246219, 0.52250099, 0.46353254, 0.51433992, 0.45985988, 0.53173864, 0.34070364, 0.38629422, 0.60624546, 0.51837605, -0.96652490, 0.54645294, 0.55150926, 0.36764500, 0.41055453, 0.30428511, 0.57697588, 0.52997559, 0.51727843, 0.40634623, 0.42968488, 0.14243253, 0.37974736, 0.47114408, 0.47507623, 0.61517555, -0.65406966, 0.32358056
    };
    const float W3_1[HIDDEN_SIZE_3][HIDDEN_SIZE_2] = 
    {
    {0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000},
    {-0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000},
    {0.00000000, -0.00000047, 0.00000000, -0.00000000, -0.00000003, -0.00000375, -0.00000000, 0.00000000, -0.00000000, -0.00013505, 0.00000000, -0.00000000, -0.00002199, 0.00000000, 0.00000000, -0.00000000, -0.00000046, -0.00000000, -0.00000049, 0.00000001, 0.00000000, -0.00000000, -0.00000067, 0.00000000, -0.00000005, -0.00000000, 0.00000000, 0.00000001, 0.00000000, -0.00001058, 0.00000000, -0.00000000},
    {0.00017491, -0.00096262, -0.00035609, 0.00046058, -0.00121831, -0.00287881, 0.00102055, 0.00103218, -0.00014260, -0.00688894, -0.00231480, -0.00256801, -0.00229866, 0.00017189, 0.00005251, -0.00099597, -0.00178020, -0.00172315, -0.00524483, -0.00081046, -0.00010261, -0.00200119, -0.00049689, 0.00015664, -0.00290517, -0.00000068, 0.00061090, -0.00307807, -0.00211040, -0.00009912, -0.00025427, -0.00147805},
    {-0.01067938, -0.02445720, -0.02818093, -0.02598076, -0.02354112, -0.01704182, -0.01516266, -0.03191762, -0.01992764, -0.01822678, -0.00541599, -0.01252563, -0.01272782, -0.02592799, 0.03527662, -0.02367523, -0.01910183, -0.01900730, -0.01240163, -0.02114359, -0.02863257, -0.02134939, -0.02803545, -0.00800945, -0.02657704, -0.00517266, -0.01248831, -0.00586488, -0.02281427, -0.01864620, 0.02880942, -0.02308315},
    {0.87490332, 0.38408574, 1.08791864, 0.24274676, 0.19912393, 0.19357044, 0.09141048, 0.28443089, 0.46156046, 0.28803858, 0.10888163, 0.22406641, 0.16174215, 0.50739557, -0.66842437, 0.23382063, 0.23715679, 0.06422889, 0.21031390, 0.03192249, 0.13795006, 0.23745133, 0.09486919, 0.28321713, 0.25793734, -1.30776799, 0.20931129, 0.20817910, 0.26303706, 0.27002648, -0.56389683, 0.06899348},
    {0.91640586, 0.30122170, 1.08984792, 0.18280594, 0.05339042, 0.24821478, 0.16003786, 0.27881637, 0.42521197, 0.22820339, 0.18887949, 0.15187275, 0.08330300, 0.49772817, -0.47511891, 0.21262597, 0.26640308, 0.31242296, 0.29608494, 0.29564041, 0.09971857, -0.01620765, 0.28504658, 0.06014578, 0.24235505, -1.29027557, 0.16597115, 0.18058398, 0.07281020, 0.20436238, -0.33183983, 0.30196935},
    {0.97898948, 0.15067479, 1.17843616, 0.13440809, 0.11910419, -0.03457352, 0.24183023, 0.35702285, 0.49584696, -0.03772030, -0.05395241, 0.02704200, 0.08623590, 0.47368008, -1.29938281, 0.23908116, 0.02682471, 0.05363528, 0.04420264, 0.10213652, 0.22689787, -0.00978135, 0.20547292, 0.18834686, 0.12287494, -1.30248761, 0.06675392, 0.14347190, 0.10464226, 0.06875038, -1.33562410, 0.18770747},
    {0.90022433, 0.12817077, 1.11255860, 0.21900573, 0.04102625, 0.14559521, 0.11804275, 0.50929964, 0.52899444, 0.15596941, 0.09409305, 0.26973385, 0.24636966, 0.54341984, -0.71009403, 0.22944449, 0.22357962, 0.10197554, 0.02047461, 0.19914570, 0.15846007, 0.13583285, 0.18291619, 0.20441560, 0.12193676, -1.30167723, 0.23832951, 0.17913233, 0.27031472, 0.14697151, -0.71570486, 0.13489875},
    {-0.66830587, 0.03999695, -0.67287093, 0.00136485, 0.00635969, 0.00942977, 0.12954557, -0.50585061, -0.70703822, 0.06568861, 0.00083946, 0.05527712, 0.06974339, -0.63249403, -0.06123694, 0.11909294, 0.06897774, 0.00536487, -0.01029307, -0.09022215, 0.24428368, -0.01807463, 0.08941635, -0.10383990, 0.04536484, 0.88479924, 0.11725273, -0.06384109, -0.00318663, 0.07778402, -0.04660207, -0.02240528},
    {0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000},
    {0.99762142, 0.07085047, 1.18900502, 0.18182391, 0.21497124, -0.07845929, -0.06784583, 0.37085527, 0.50370818, 0.03255055, 0.11418686, 0.14201075, 0.19726720, 0.57147098, -1.29741347, 0.13709745, -0.01775782, -0.00066873, 0.05302014, 0.16751669, 0.14333235, 0.09413549, 0.16897686, 0.17392512, 0.01232074, -1.22768426, 0.05072876, 0.03714609, 0.09327042, -0.08499698, -1.41343772, 0.08296313},
    {-0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000},
    {0.94215810, 0.21950889, 1.09994447, 0.26250172, 0.24998815, 0.04235116, 0.20688599, 0.25301901, 0.47664016, 0.00677373, 0.01935322, 0.16967098, 0.33886081, 0.49477690, -0.60337174, 0.03637047, 0.00877875, 0.24883403, 0.22813436, 0.21331415, 0.27842072, 0.11650820, 0.20937295, 0.19178005, 0.02581093, -1.28184569, 0.17609462, 0.24614429, 0.24349473, 0.19967254, -0.58212942, 0.24094607},
    {0.96792436, 0.19862431, 1.06824338, 0.21740609, 0.26604962, 0.20244388, 0.11453573, 0.48361367, 0.44827893, -0.02888847, 0.02027379, -0.01413160, 0.02518982, 0.41404891, -1.28497863, 0.09503206, 0.15463884, 0.24105550, -0.01917389, 0.04098684, 0.19606604, 0.18014865, 0.13051203, 0.24788797, 0.12203811, -1.35960841, 0.08289105, 0.14779630, 0.19515909, 0.02596075, -1.36679077, -0.01718077},
    {-0.00000003, -0.00041418, -0.00000364, -0.00070914, -0.00053195, -0.00225660, -0.00022486, 0.00008681, 0.00005254, -0.00094877, 0.00030995, -0.00125988, -0.00036619, 0.00010020, -0.00077074, -0.00073107, -0.00026919, -0.00277439, -0.00117602, -0.00075141, -0.00141858, -0.00082227, -0.00039738, -0.00082243, -0.00376607, 0.00000144, -0.00006136, -0.00079835, -0.00032633, -0.00010053, 0.00077655, -0.00258613},
    {0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000},
    {0.96299696, 0.12267385, 1.14071286, 0.22161497, 0.30377758, 0.18681146, 0.14057463, 0.40009308, 0.40574983, 0.22325237, 0.17900936, 0.21008535, 0.22132468, 0.44924840, -0.63146061, 0.22447777, 0.15279640, 0.06996758, 0.19715016, 0.15567102, 0.01525861, 0.24941234, 0.21226825, 0.01438880, 0.16807240, -1.32184553, -0.01475865, 0.08229838, 0.13053098, 0.04125392, -0.38458562, 0.00402198},
    {0.00000000, 0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, 0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000},
    {-0.37826353, 0.07630916, -0.60153323, 0.01944748, 0.01087885, 0.04907073, 0.03973409, -0.35901198, -0.47020292, 0.01956624, -0.04573386, 0.03130843, 0.04187452, -0.46878898, 0.22772980, 0.10029405, 0.06311456, 0.02225010, 0.01019335, -0.02222550, 0.12746607, 0.05314751, 0.06401882, -0.01466206, 0.06889897, 0.67147183, 0.03921703, -0.00156424, 0.00274546, 0.05023202, -0.24636593, 0.02075870},
    {0.90736282, 0.23692778, 1.15863466, 0.24037692, 0.11229622, 0.27882650, 0.17595243, 0.42826882, 0.47760144, 0.09362064, 0.13989852, 0.19167417, 0.22967760, 0.46818206, -0.43999732, 0.13253498, 0.19447416, 0.05212889, 0.29243720, 0.24000096, 0.29728830, 0.28176907, 0.24103731, 0.12065843, 0.07684846, -1.37495363, 0.21009409, 0.08597521, 0.25061250, 0.11134223, -0.28415057, 0.03006259},
    {0.95678127, 0.03329858, 1.14626002, 0.11240211, 0.30504030, 0.24549009, 0.12521935, 0.35926175, 0.46379787, 0.02018233, 0.10741617, 0.16140112, 0.24678278, 0.56958443, -1.05310071, 0.14892542, 0.25188470, 0.13755062, -0.04504015, 0.04801845, 0.10700735, 0.19688958, 0.13732055, 0.20966998, 0.15051761, -1.20643663, 0.02484770, 0.02489689, 0.15982813, 0.16088784, -1.07573175, 0.07840330},
    {0.95523250, 0.20990075, 1.08261609, -0.01196677, 0.23273048, 0.09108821, -0.00991211, 0.19780442, 0.40103227, 0.20002089, 0.21327643, 0.23187217, 0.07450411, 0.35129774, -0.76081699, 0.17736250, 0.08661672, 0.14317989, 0.21196730, 0.11400656, 0.14636202, 0.20884113, 0.02115977, 0.25462055, 0.05542698, -1.38192713, 0.18471606, 0.20334440, 0.09360632, 0.23787899, -0.75272071, 0.13642071},
    {-0.39575940, 0.02792419, -0.49984390, -0.00555386, -0.00611256, 0.02183169, 0.13347487, -0.37929681, -0.49591359, 0.04269864, 0.00173957, 0.04772256, 0.02483565, -0.47682655, -0.09040216, 0.06416602, 0.01342374, 0.00585421, 0.00700784, -0.03343615, 0.22388418, -0.05499799, 0.06088261, -0.07861784, 0.02407618, 0.43288940, 0.09072933, -0.06806434, -0.02602333, 0.07213641, -0.03059937, -0.03455232},
    {-0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000003, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000001, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000},
    {0.72084165, 0.25543696, 0.98663086, 0.25257176, 0.17329490, 0.18244539, 0.23957391, 0.40232763, 0.47525433, 0.24123107, 0.18742745, 0.17153291, 0.21231607, 0.49145031, -0.11787621, 0.22381997, 0.16919106, 0.22728875, 0.20004092, 0.18285233, 0.21605703, 0.15824875, 0.17918707, 0.24586976, 0.14732167, -0.87646890, 0.18557961, 0.22267012, 0.21311113, 0.25474456, -0.00352359, 0.18744399},
    {-0.00000001, -0.00001195, 0.00000000, -0.00001142, -0.00002128, -0.00001554, 0.00000565, 0.00000134, 0.00000004, 0.00012412, -0.00010884, 0.00004442, -0.00001693, 0.00000002, -0.00000001, -0.00007814, -0.00005427, -0.00002926, -0.00004300, -0.00011043, -0.00001558, -0.00007037, -0.00004433, 0.00000681, -0.00003418, -0.00000001, -0.00005195, -0.00001805, -0.00000336, -0.00003422, -0.00000001, -0.00002165},
    {0.96086991, 0.27678326, 1.13959002, 0.10870917, 0.10328379, 0.13204788, -0.01972595, 0.47417235, 0.45373085, -0.03140301, 0.13633578, 0.20258687, 0.08453207, 0.41021878, -1.24207771, 0.02180779, 0.17178024, 0.19414850, -0.05549350, -0.05110948, 0.19221428, 0.07190768, 0.15997136, 0.07005356, 0.15325432, -1.29623640, 0.22635403, 0.15730913, 0.16084437, 0.10987130, -1.32330227, -0.01757614},
    {0.92692351, 0.15139014, 1.12694728, 0.11182717, 0.16244183, 0.11560177, 0.27823290, 0.32252100, 0.45082244, 0.28329352, 0.27261606, 0.00798806, 0.05596492, 0.52056062, -0.51100475, 0.20005953, 0.00545796, 0.07326864, 0.21527058, 0.06560829, 0.23982735, 0.05771014, 0.16709790, 0.07229555, 0.19342627, -1.41059220, 0.10511170, 0.28891230, 0.12411667, 0.11272863, -0.43461850, 0.24173611},
    {0.89918333, 0.09363279, 1.15358400, 0.05139290, 0.00416939, 0.13168636, 0.14145657, 0.29944089, 0.49004525, 0.25167707, 0.16029508, 0.02334581, 0.03298796, 0.41119567, -0.82375920, 0.27580819, 0.30690011, 0.30955243, 0.15710528, 0.18887430, 0.26616058, 0.09913795, 0.03283386, 0.11699814, 0.00220895, -1.18302643, 0.27482098, 0.18274310, 0.12435409, 0.20114835, -0.85526371, 0.17922775},
    {-0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000, -0.00000000, -0.00000000, -0.00000000, 0.00000000, -0.00000000},
    {0.91115838, 0.11756049, 1.04756153, 0.13995887, 0.00016928, 0.16032718, 0.25640589, 0.42845765, 0.45153746, 0.07043436, 0.13102293, 0.21862531, 0.05596368, 0.41927809, -0.71878773, 0.06162209, 0.23029983, 0.02158707, 0.21357174, 0.24665658, 0.08457015, 0.08240982, 0.16868849, 0.06609496, 0.16072734, -1.39370036, -0.01457443, 0.15038823, 0.13063085, 0.14597403, -0.64862186, 0.22008871},
    };
    const float b3_1[HIDDEN_SIZE_3] = 
    {
    -0.00000000, -0.00000000, -0.00000000, 0.00046991, -0.02321360, 1.01288009, 1.06180143, 1.06197631, 1.12805903, -0.30890089, -0.00000000, 0.95944679, -0.00000000, 1.05827534, 0.97730482, 0.00042077, -0.00000000, 1.17389524, -0.00000000, -0.53144938, 1.11496031, 1.18426776, 1.16892385, -0.03095645, -0.00000000, 1.18372583, -0.00000251, 1.03809297, 1.07828915, 0.95314395, -0.00000000, 1.14777100
    };
    const float W4_1[HIDDEN_SIZE_3] = 
    {
    0.00000000, -0.00175382, 0.00084941, -0.01233565, -0.03069633, 0.43210372, 0.43288177, 0.68320972, 0.45855561, -0.56777358, 0.01519075, 0.67845684, -0.00001472, 0.48535621, 0.62705702, -0.00334015, -0.00000000, 0.53331053, -0.00000000, -0.58068973, 0.46523422, 0.56852192, 0.55338788, -0.42507297, -0.00733740, 0.42337173, -0.00468103, 0.67438960, 0.51921618, 0.52345389, 0.00621592, 0.55687940
    };
    const float b4_1 = 2.15907288;

    for (int i = 0; i < INPUT_SIZE; i++) 
    {
        params_1->mean[i] = mean_1[i]; // 设置初始值
        params_1->std[i] = std_1[i];
    }


    arm_mat_init_f32(&params_1->W1, HIDDEN_SIZE_1, INPUT_SIZE, (float *)W1_1); // 初始化矩阵
    for (int i = 0; i < HIDDEN_SIZE_1; i++) 
    {
        params_1->b1[i] = b1_1[i]; // 初始化偏置
    }


    arm_mat_init_f32(&params_1->W2, HIDDEN_SIZE_2, HIDDEN_SIZE_1, (float *)W2_1); // 初始化矩阵
    for (int i = 0; i < HIDDEN_SIZE_2; i++) 
    {
        params_1->b2[i] = b2_1[i]; // 初始化偏置
    }

    arm_mat_init_f32(&params_1->W3, HIDDEN_SIZE_3, HIDDEN_SIZE_2, (float *)W3_1); // 初始化矩阵
    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        params_1->b3[i] = b3_1[i]; // 初始化偏置
    }

    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        params_1->W4[i] = W4_1[i]; // 直接初始化 W4 数组
    }
    params_1->b4 = b4_1; // 初始化偏置

    // 初始化 params_2，类似 params_1
    for (int i = 0; i < INPUT_SIZE; i++) 
    {
        params_2->mean[i] = mean_1[i]; // 设置初始值
        params_2->std[i] = std_1[i];
    }

    arm_mat_init_f32(&params_2->W1, HIDDEN_SIZE_1, INPUT_SIZE, (float *)W1_1);
    for (int i = 0; i < HIDDEN_SIZE_1; i++) 
    {
        params_2->b1[i] = b1_1[i];
    }

    arm_mat_init_f32(&params_2->W2, HIDDEN_SIZE_2, HIDDEN_SIZE_1, (float *)W2_1);
    for (int i = 0; i < HIDDEN_SIZE_2; i++) 
    {
        params_2->b2[i] = b2_1[i];
    }

    arm_mat_init_f32(&params_2->W3, HIDDEN_SIZE_3, HIDDEN_SIZE_2, (float *)W3_1);
    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        params_2->b3[i] = b3_1[i];
    }

    // 初始化 params_2 的 W4
    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        params_2->W4[i] = W4_1[i]; // 直接初始化 W4 数组
    }
    params_2->b4 = b4_1; // 初始化偏置

    DEBUG_PRINT("MLP parameters initialized.\n");
}

void free_mlp_params(MLPParams* params_1, MLPParams* params_2) 
{
    // 如果使用动态内存分配某些参数，可以在这里释放
    free(params_1);
    free(params_2);

    DEBUG_PRINT("MLP parameters freed.\n");
}


void normalization(const float* data, const float* mean, const float* std, float* normalized_data) 
{
    for (int i = 0; i < INPUT_SIZE; i++) 
    {
        normalized_data[i] = (data[i] - mean[i]) / std[i];
    }
}

void relu(const float* x, float* output, int size) 
{
    for (int i = 0; i < size; i++) {
        output[i] = fmax(0, x[i]);
    }
}
void mlp_inference(const float* input_data, 
                   const arm_matrix_instance_f32* W1, const float* b1,
                   const arm_matrix_instance_f32* W2, const float* b2,
                   const arm_matrix_instance_f32* W3, const float* b3,
                   const float* W4, const float b4,
                   float* output) 
{
    arm_matrix_instance_f32 input, z1, z2, z3;
    float z1_data[HIDDEN_SIZE_1], z2_data[HIDDEN_SIZE_2], z3_data[HIDDEN_SIZE_3];

    // Initialize the matrices using 1D arrays (already flattened)
    arm_mat_init_f32(&input, INPUT_SIZE, 1, (float*)input_data);
    arm_mat_init_f32(&z1, HIDDEN_SIZE_1, 1, z1_data);
    arm_mat_init_f32(&z2, HIDDEN_SIZE_2, 1, z2_data);
    arm_mat_init_f32(&z3, HIDDEN_SIZE_3, 1, z3_data);

    // Forward pass (matrix multiplication and bias addition)
    arm_mat_mult_f32(W1, &input, &z1);
    for (int i = 0; i < HIDDEN_SIZE_1; i++) {
        z1_data[i] += b1[i];
    }
    relu(z1_data, z1_data, HIDDEN_SIZE_1);

    // Second layer forward pass
    arm_mat_mult_f32(W2, &z1, &z2);
    for (int i = 0; i < HIDDEN_SIZE_2; i++) {
        z2_data[i] += b2[i];
    }
    relu(z2_data, z2_data, HIDDEN_SIZE_2);

    // Third layer forward pass
    arm_mat_mult_f32(W3, &z2, &z3);
    for (int i = 0; i < HIDDEN_SIZE_3; i++) {
        z3_data[i] += b3[i];
    }
    relu(z3_data, z3_data, HIDDEN_SIZE_3);

    // Output layer
    *output = 0;
    for (int i = 0; i < HIDDEN_SIZE_3; i++) {
        *output += z3_data[i] * W4[i];
    }
    *output += b4;
}

void process_whisker(const float* input_data, const float* mean, const float* std,
                     const arm_matrix_instance_f32* W1, const float* b1,
                     const arm_matrix_instance_f32* W2, const float* b2,
                     const arm_matrix_instance_f32* W3, const float* b3,
                     const float* W4, const float b4,
                     float* output) 
{
    float normalized_data[INPUT_SIZE];
    normalization(input_data, mean, std, normalized_data);
    mlp_inference(normalized_data, W1, b1, W2, b2, W3, b3, W4, b4, output);
}

void dis_net(StateWhisker *statewhisker, MLPParams* params_1, MLPParams* params_2) 
{
    float input_data_1[INPUT_SIZE] = {statewhisker->whisker1_1, statewhisker->whisker1_2, statewhisker->whisker1_3};
    float input_data_2[INPUT_SIZE] = {statewhisker->whisker2_1, statewhisker->whisker2_2, statewhisker->whisker2_3};

    process_whisker(input_data_1, params_1->mean, params_1->std, &params_1->W1, params_1->b1, 
                    &params_1->W2, params_1->b2, &params_1->W3, params_1->b3, 
                    params_1->W4, params_1->b4, &statewhisker->mlpoutput_1);
    
    process_whisker(input_data_2, params_2->mean, params_2->std, &params_2->W1, params_2->b1, 
                    &params_2->W2, params_2->b2, &params_2->W3, params_2->b3, 
                    params_2->W4, params_2->b4, &statewhisker->mlpoutput_2);
}