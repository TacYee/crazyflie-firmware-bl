#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "CF_whiskers_onboard.h"
#include "mlp.h"
#include "debug.h"
#include "arm_math.h"


void normalization(const float* data, const float* mean, const float* std, float* normalized_data) 
{
    for (int i = 0; i < INPUT_SIZE; i++) 
    {
        normalized_data[i] = (data[i] - mean[i]) / std[i];
    }
}

void relu(const float* x, float* output, int size) 
{
    for (int i = 0; i < size; i++) 
    {
        output[i] = fmax(0.0f, x[i]);
    }
}

void mlp_inference(const float* input_data, float* output) 
{
    const float W1_1[32][3] = {
        {-0.0398871488869190, -0.9068560600280762, 0.1739770174026489},
        {0.4453406333923340, 0.1743497848510742, -0.6699312925338745},
        {0.3186129927635193, -0.5884728431701660, 0.2567510604858398},
        {0.1070689335465431, 1.0542733669281006, 0.4857715666294098},
        {0.0323523208498955, -0.6106306910514832, 0.0985245481133461},
        {-0.0040172194130719, 0.7418471574783325, -0.3396126925945282},
        {0.5335779786109924, 0.3795863091945648, -0.5146390199661255},
        {0.1449491381645203, 0.0654371455311775, 0.9303331375122070},
        {0.0137713626027107, -0.6396908760070801, 0.1359310448169708},
        {0.5160579085350037, -0.7320436835289001, 0.3865013420581818},
        {0.0037213421892375, -0.8529027700424194, 0.1362627297639847},
        {0.3368701040744781, 1.0957143306732178, -0.1717770099639893},
        {0.1649485975503922, -0.3342019021511078, 0.1281133890151978},
        {-0.0577158406376839, 0.7566430568695068, -0.4208462238311768},
        {0.5475438833236694, -0.5960108637809753, 0.0363605991005898},
        {1.0785629749298096, 0.7792089581489563, -0.0671181902289391},
        {0.3592881262302399, -0.1388320475816727, -0.6037904620170593},
        {-0.1718695610761642, -0.5247855186462402, -0.6555539369583130},
        {-0.2704196572303772, 0.7607981562614441, 0.0484035797417164},
        {0.4982533454895020, 0.2300322055816650, 0.1573688685894012},
        {0.5576975345611572, 0.9581293463706970, -0.1584224402904510},
        {0.1649999618530273, -0.5737795829772949, 0.1488040983676910},
        {-0.3356384932994843, -0.0171880051493645, -0.5325513482093811},
        {-0.0134794292971492, -0.3203858435153961, -0.4308260381221771},
        {0.6497762799263000, -0.4780592322349548, -0.2976599931716919},
        {0.5470883846282959, 0.8294556140899658, -0.0425531156361103},
        {-0.0442207641899586, 0.0917544141411781, -0.3557398319244385},
        {-0.5153448581695557, 0.1543544679880142, 0.1868621259927750},
        {0.3145565986633301, 0.1060850471258163, -0.0896597057580948},
        {-0.2675451040267944, -0.1216039806604385, 1.1428297758102417},
        {-0.2995180785655975, -0.2408742308616638, 1.0469409227371216},
        {0.8167363405227661, 0.4218137562274933, 0.4979204237461090},
    };
    const float b1_1[32] = {
        0.3473581373691559, -0.0520363301038742, 0.0153157189488411, 0.2792414724826813, 0.3330124318599701, -0.5304524302482605, -0.0657286942005157, 0.1719980239868164, 0.3072918951511383, 0.0210265163332224, 0.4554072320461273, -0.2469102591276169, 0.3703981339931488, -0.5076097846031189, 0.0270387064665556, -0.0772527381777763, 0.1378252059221268, -0.1780551373958588, 0.2487459480762482, 0.4341152310371399, -0.4739690124988556, 0.0777716338634491, 0.2544081807136536, 0.3995531797409058, -0.2327902466058731, -0.3894097208976746, 0.4200161397457123, -0.7880746722221375, 0.5478298664093018, -0.2506595849990845, -0.2620880007743835, 0.3356310427188873
    };
    const float W2_1[32][32] = {
        {-0.3656418919563293, -0.0931883826851845, -0.0069869859144092, 0.0343675687909126, 0.4703493416309357, -0.0141286626458168, 0.0458498895168304, 0.0143498396500945, 0.1010990515351295, -1.0248107910156250, 0.3156478703022003, 0.1530782878398895, -0.9460475444793701, -0.0182939544320107, -1.4239097833633423, 0.2919783294200897, -0.1947940886020660, -1.0707578659057617, -0.0431625470519066, 0.1533376574516296, 0.6093046069145203, 0.0841334685683250, -0.1802382320165634, -0.4149983227252960, -1.6262557506561279, 0.3552602827548981, -0.0779019296169281, -0.4159034192562103, 0.0453010499477386, -0.7312188744544983, -1.0265297889709473, 0.2101992964744568},
        {0.2260894626379013, -0.0971764698624611, 0.1363751888275146, 0.0277117304503918, 0.0171297062188387, 0.2095213234424591, -0.0301359444856644, 0.0990301296114922, 0.2556367218494415, 0.0961029678583145, 0.0450896956026554, 0.0141278216615319, -0.0123098101466894, 0.1001833975315094, 0.1279682964086533, -0.1854016482830048, 0.0129732992500067, 0.0587657466530800, -0.0298960767686367, -0.0123079270124435, -0.0455675348639488, 0.2507373094558716, -0.0856064409017563, -0.1472861617803574, -0.0234288070350885, -0.1047037988901138, 0.0816686898469925, -0.6966136097908020, -0.0464213266968727, -0.0148658379912376, 0.0326094403862953, 0.0772144943475723},
        {-0.0931514948606491, 0.0006276259664446, 0.0828567817807198, -2.2122600078582764, -0.1345163136720657, -0.4434275925159454, 0.0681441873311996, -0.0400843992829323, -0.0871822610497475, -0.0225069895386696, -0.2779695689678192, -1.8849427700042725, -0.1418675035238266, -0.9270433783531189, 0.1683693528175354, 0.3693957030773163, -0.0353981740772724, 0.0959830284118652, -1.2818459272384644, 0.1678858846426010, -1.6266044378280640, 0.0336470268666744, -0.0482734292745590, 0.1923913657665253, -0.0817065685987473, -0.8005570769309998, -0.0129785872995853, -0.1928400099277496, 0.1442452222108841, 0.2313760519027710, 0.0696349814534187, 0.1397609114646912},
        {0.1620512157678604, -0.0289178583770990, 0.2505396306514740, -0.0838620290160179, 0.0145630855113268, 0.2492400407791138, -0.0437948778271675, -0.0538134798407555, 0.1979637295007706, -0.0098927747458220, 0.0913540348410606, 0.0485061816871166, 0.1029376238584518, 0.0759821310639381, 0.0332207828760147, 0.1010562628507614, 0.0308743882924318, 0.0920765325427055, 0.1764106601476669, -0.0573211126029491, -0.0071545871905982, 0.1009840667247772, -0.1160248070955276, -0.0071603371761739, 0.1660282313823700, 0.1912313252687454, -0.0281488150358200, -0.7023559212684631, -0.0326124615967274, 0.1329615712165833, 0.1111049279570580, -0.1192877441644669},
        {0.1942841112613678, -0.0498400218784809, 0.2449310719966888, -0.0686153396964073, 0.1813747137784958, 0.2638402283191681, 0.1539617031812668, 0.0917398780584335, 0.1593003720045090, 0.0791517049074173, 0.0829498022794724, 0.2036654651165009, 0.0345135629177094, 0.1163408160209656, -0.0510640740394592, 0.0591842122375965, -0.1331044882535934, -0.0314922928810120, 0.0806246250867844, -0.0777246952056885, -0.0142329372465611, 0.0165118351578712, 0.0197022669017315, -0.1928143054246902, 0.2051219493150711, 0.0402140617370605, 0.0247923620045185, -0.6089126467704773, -0.0030003390274942, -0.0162146463990211, 0.0255482066422701, -0.1226285472512245},
        {0.0288315396755934, -0.0783048719167709, 0.2012496441602707, 0.1430635601282120, 0.2034304738044739, 0.1176181659102440, -0.0836860388517380, 0.1491398811340332, 0.2040319740772247, -0.0008831695304252, 0.2551884949207306, 0.1167751550674438, -0.1225859746336937, 0.1520301252603531, -0.0530066564679146, -0.0908774435520172, 0.1184236332774162, 0.0816827863454819, -0.0976919084787369, -0.0306414663791656, -0.1186031475663185, 0.2095878571271896, -0.0773759931325912, -0.0540001727640629, 0.1709692925214767, -0.0233860444277525, -0.0197412446141243, -0.7045630216598511, 0.0799194052815437, 0.0126559752970934, 0.0429359860718250, 0.0662501305341721},
        {0.1223162636160851, 0.1048743948340416, -0.0160365868359804, -0.1581461578607559, 0.2578731477260590, 0.1042243614792824, -0.0011193364625797, 0.0184672269970179, 0.0733964890241623, -0.0044632214121521, 0.0488927923142910, 0.0429304540157318, -0.0089018959552050, -0.0359934531152248, 0.0506384260952473, 0.0466382876038551, -0.0861708000302315, -0.0660378187894821, 0.1219190061092377, 0.0982387289404869, 0.0257147401571274, 0.2693823277950287, -0.0229338034987450, 0.0972514152526855, 0.1665999889373779, 0.1060651466250420, 0.0838463157415390, -0.8376741409301758, -0.1269855648279190, 0.0219455342739820, 0.1902382522821426, 0.0292192623019218},
        {-0.0260658059269190, 0.3448926806449890, -0.0301124546676874, -0.3803301155567169, -0.0626531988382339, -0.2112525105476379, 0.1090819388628006, 0.1181079819798470, 0.0858912393450737, -0.0410729199647903, -0.1451441496610641, -1.0952780246734619, 0.1069630831480026, -0.4065290391445160, 0.1286947578191757, -0.1543901562690735, 0.2458937317132950, -0.1569714993238449, -0.1151475980877876, -0.0261060353368521, -1.2867462635040283, -0.1130517795681953, 0.0764399021863937, 0.0930755510926247, 0.2004959434270859, -1.1032649278640747, 0.0738523453474045, -1.1336660385131836, -0.1040924042463303, 0.2514771521091461, 0.2157380580902100, -0.0432979911565781},
        {-0.0960304066538811, 0.3050732016563416, 0.0470003299415112, -0.2726671397686005, -0.0110131176188588, -0.3120678961277008, 0.2516835927963257, 0.0876621007919312, -0.1191538870334625, 0.0454526692628860, -0.1239613443613052, -1.3245942592620850, -0.0258330684155226, -0.4523074030876160, 0.0531025677919388, 0.0075457445345819, 0.1406165361404419, -0.1705138087272644, -0.1171711534261703, -0.0513906255364418, -1.5358065366744995, -0.0817577466368675, 0.0341513417661190, 0.0793895125389099, 0.1467736065387726, -1.1262269020080566, 0.0232477337121964, -1.2242646217346191, -0.0136386072263122, 0.2433285415172577, 0.1812053322792053, -0.1251891106367111},
        {0.0634775757789612, 0.1742742657661438, 0.2150949835777283, -0.0299767944961786, 0.2109854668378830, 0.1946260780096054, -0.0460061989724636, 0.1392212808132172, 0.1401641219854355, -0.0011927987216040, 0.2353090047836304, 0.0346860587596893, 0.1338078677654266, 0.0605551749467850, 0.1799635589122772, -0.1162685379385948, -0.0519970357418060, 0.0770205035805702, -0.0284437257796526, 0.1183609142899513, -0.0132955471053720, 0.3006897270679474, 0.1364236325025558, -0.0246047023683786, 0.0367515943944454, -0.0091517427936196, 0.1400788724422455, -0.6950490474700928, -0.1191092804074287, 0.0860235616564751, 0.0066037881188095, 0.1426543444395065},
        {0.0716320425271988, 0.0249472334980965, 0.0321721695363522, -0.1506017297506332, 0.2117188423871994, 0.2770849466323853, 0.0757784768939018, 0.2378954291343689, 0.0732097774744034, 0.2095742523670197, 0.0901793092489243, 0.0758240073919296, -0.0482793636620045, 0.1826505511999130, -0.1165922582149506, -0.0179373901337385, 0.1199773252010345, 0.1282602697610855, 0.0714293345808983, 0.1077523231506348, -0.0375826023519039, 0.0303879547864199, 0.1082852184772491, 0.0791708007454872, 0.1726388186216354, -0.0592090636491776, -0.1062089130282402, -0.8221815228462219, -0.1340162009000778, 0.0422665551304817, 0.2061689943075180, 0.1261030137538910},
        {0.1722632050514221, 0.0913570001721382, 0.1512701809406281, -0.0805659368634224, 0.1729028373956680, 0.3490012884140015, -0.1074223741889000, 0.0169077049940825, 0.1746934950351715, 0.0790257006883621, 0.2189197242259979, -0.0951676964759827, 0.1655960828065872, 0.0717703476548195, 0.0180566236376762, 0.1004816666245461, -0.1401163488626480, 0.1163342744112015, -0.0365210957825184, 0.0788834095001221, 0.0555833876132965, 0.0165933016687632, 0.0350503884255886, -0.1125713214278221, 0.0397706180810928, 0.1479074209928513, 0.1444498002529144, -0.6625459790229797, -0.0223942007869482, 0.0203417092561722, 0.1327834427356720, 0.0121703539043665},
        {0.1980129927396774, 0.1248686090111732, 0.2112679928541183, 0.0023788881953806, 0.1113798767328262, 0.0888221785426140, 0.1272865980863571, 0.0961509495973587, 0.0112689873203635, 0.0732398629188538, 0.2626921534538269, -0.0199454054236412, 0.0695444941520691, 0.0284591466188431, 0.1053668707609177, 0.0141416266560555, -0.1525638699531555, -0.0914281532168388, 0.1331961452960968, -0.0705383196473122, -0.1089978888630867, 0.2059748917818069, -0.1119751557707787, -0.0461451075971127, 0.1477083563804626, 0.1330839991569519, 0.0251644756644964, -0.7204302549362183, -0.0465423502027988, 0.0988249629735947, 0.0918644517660141, -0.1379435807466507},
        {-0.1485212445259094, 0.2354661077260971, -0.0245285108685493, -0.3305060863494873, -0.1393810063600540, -0.2479525357484818, 0.2219768166542053, 0.1173304915428162, -0.1292682737112045, 0.0674287304282188, -0.1096294671297073, -1.1401007175445557, 0.1142028942704201, -0.2962015867233276, 0.0938699617981911, -0.0394154563546181, 0.1807869374752045, -0.0728192180395126, -0.1615811437368393, -0.0402189306914806, -1.4087542295455933, -0.0034220803063363, 0.1399202793836594, 0.1043712943792343, 0.1088510304689407, -1.0341647863388062, -0.0260889530181885, -1.2363399267196655, -0.0650333464145660, 0.2816236913204193, 0.2290802747011185, -0.0657871812582016},
        {0.1090887859463692, -1.0225423574447632, 0.1583941280841827, -0.0069673121906817, 0.0752942860126495, 0.1108959242701530, -0.7526183128356934, 0.1353840380907059, 0.1051828786730766, 0.0258332211524248, 0.1346587240695953, 0.1172008737921715, -0.0683095753192902, 0.0990501046180725, 0.3296140432357788, 1.1371588706970215, -0.7318751811981201, -0.0888211503624916, 0.1344911456108093, -0.3353095650672913, 0.3003834187984467, 0.0799950435757637, -0.3721584975719452, -0.3056033849716187, -0.1741670221090317, 0.9374988675117493, -0.4672940075397491, 0.3942440152168274, -0.5657668113708496, 0.3281109929084778, 0.3315909504890442, -0.2212164998054504},
        {0.1265186369419098, -0.1262492537498474, 0.0177348908036947, -0.0789045915007591, 0.1771114319562912, 0.1228442415595055, 0.1140227764844894, 0.1395796984434128, 0.0865800157189369, 0.1457192897796631, 0.2780509293079376, 0.0914183109998703, 0.1196697801351547, 0.0766240805387497, 0.0405857302248478, 0.1137226000428200, 0.0507584437727928, -0.0995921343564987, 0.1516712456941605, 0.0454806610941887, 0.0718353092670441, 0.1722615063190460, -0.1778701245784760, -0.0202773604542017, -0.0465852394700050, -0.0071540088392794, -0.0199283752590418, -0.6902475953102112, -0.0697826743125916, 0.0660247355699539, -0.0963274240493774, -0.1234230548143387},
        {0.0135593367740512, -0.1157118529081345, 0.1773833632469177, 0.0092311650514603, -0.0204238221049309, 0.1613707542419434, -0.0140330847352743, 0.0265546236187220, 0.1975023150444031, 0.0871586054563522, 0.2601449787616730, 0.1529499143362045, 0.1497166305780411, 0.1916660666465759, -0.0071932920254767, 0.1159036904573441, -0.0318797677755356, 0.0304662082344294, -0.0360054746270180, -0.1280889511108398, 0.0307975001633167, 0.1786258518695831, 0.0086012929677963, -0.0635575577616692, 0.1163819655776024, -0.0750755146145821, -0.0174271631985903, -0.6534123420715332, -0.0343156903982162, 0.0465599261224270, 0.0359661951661110, -0.0518596209585667},
        {0.2850781977176666, -0.0741671249270439, 0.1623868346214294, -0.0598158501088619, 0.2105299681425095, 0.1396294832229614, -0.0050269155763090, -0.0279346853494644, 0.3159994781017303, 0.1502200067043304, 0.1707657873630524, 0.1103708893060684, 0.1762334108352661, 0.1015572100877762, 0.0345616005361080, 0.0851251631975174, -0.0339939519762993, 0.1245232373476028, 0.1597469896078110, -0.0260185971856117, -0.0621986687183380, -0.0041000740602612, 0.0732241421937943, -0.0605018362402916, 0.0410049445927143, 0.1006209105253220, 0.1099903136491776, -0.5827003717422485, -0.0522211007773876, 0.1756939589977264, -0.0289308000355959, 0.1771921515464783},
        {0.0225037317723036, -0.0199618116021156, 0.0908959135413170, 0.0957160294055939, 0.1408898681402206, 0.1979888677597046, 0.0880994722247124, 0.0343494899570942, 0.2187394797801971, 0.1137658432126045, 0.3302320241928101, -0.1608131825923920, 0.1074550822377205, 0.2241218239068985, 0.1035519614815712, -0.1261055469512939, 0.1221081614494324, 0.0716912224888802, 0.0811523124575615, 0.0434912331402302, -0.0464344434440136, 0.0964685380458832, -0.0571323893964291, 0.0261878799647093, -0.0233693309128284, -0.0683137699961662, -0.1482652127742767, -0.7114583253860474, -0.0178872663527727, 0.1862316280603409, 0.1206466481089592, 0.0442357584834099},
        {0.2328689247369766, 0.0470768660306931, 0.0327011980116367, 0.1080706715583801, 0.2591980695724487, 0.3070420324802399, 0.0760029777884483, -0.0736617222428322, 0.2349566072225571, 0.2361791431903839, 0.2942545413970947, 0.0448760129511356, 0.1025888249278069, 0.1400483548641205, 0.0389060042798519, 0.0006274230545387, -0.1393592953681946, 0.0767256841063499, 0.0888817682862282, -0.0892120301723480, -0.1262486428022385, 0.0842200145125389, 0.1332846879959106, -0.1922295689582825, 0.0867074579000473, -0.0095903305336833, -0.1426696777343750, -0.6201048493385315, -0.0463689155876637, 0.1349815130233765, 0.1206099092960358, 0.0879143700003624},
        {0.0972374156117439, -0.1349556595087051, -0.0005622109165415, 0.0503504760563374, 0.0544212944805622, 0.0398743413388729, 0.0234243161976337, -0.0168306734412909, 0.1473803222179413, 0.1124137565493584, 0.0884056463837624, 0.0231191944330931, 0.0265598129481077, 0.1461824923753738, 0.0129961678758264, 0.0289662163704634, 0.0047004492953420, 0.0950413346290588, -0.0221279375255108, 0.0034010484814644, -0.2139843553304672, 0.1149635836482048, 0.0185106229037046, -0.1618919968605042, 0.1771010607481003, 0.1049491241574287, 0.0623220019042492, -0.6236197352409363, 0.0560339614748955, -0.0080760717391968, 0.0581785142421722, 0.0705933347344398},
        {0.0765692740678787, -0.0049407663755119, 0.2862947881221771, 0.0359191559255123, 0.2339679151773453, 0.2694503068923950, -0.0820384472608566, 0.0229779016226530, 0.1463411003351212, -0.0256793834269047, 0.2861548066139221, 0.0869130864739418, -0.0611238479614258, 0.2220106720924377, 0.0730926916003227, -0.1149511337280273, -0.0461657531559467, -0.0859946459531784, 0.0009279358782806, -0.0786039978265762, 0.0529706887900829, 0.2357645481824875, -0.0193276777863503, -0.0310295391827822, 0.0188966132700443, 0.0987750962376595, -0.0378303825855255, -0.6560059785842896, 0.0290705244988203, -0.1074630543589592, 0.1107371225953102, 0.0509060695767403},
        {0.0905488878488541, 0.0837674215435982, 0.0390236638486385, 0.0994909256696701, 0.0323225334286690, 0.0876434370875359, 0.1395362466573715, 0.0029385332018137, 0.0265654772520065, 0.0041784993372858, 0.3180169165134430, -0.0549229085445404, 0.1078510284423828, 0.1950353235006332, 0.0091343950480223, -0.0148027101531625, -0.0071310983039439, -0.0031554498709738, 0.0029105958528817, -0.0364135168492794, 0.0368264541029930, 0.1606989353895187, 0.0763813331723213, -0.1096108481287956, 0.0276985969394445, -0.0810260698199272, 0.0365505479276180, -0.7183027267456055, -0.0495368503034115, 0.0976841002702713, -0.0169356316328049, 0.0244265906512737},
        {0.1402726769447327, -0.0251517109572887, 0.1802493035793304, -0.0131954671815038, 0.0748644992709160, 0.2535901665687561, 0.0316247828304768, -0.0072657815180719, 0.1306290179491043, 0.0888192728161812, 0.1819375306367874, 0.1068388372659683, 0.0578139387071133, 0.3587751984596252, 0.1159466654062271, 0.0805321037769318, 0.0538801327347755, 0.1119168847799301, 0.1090075373649597, -0.1289629638195038, -0.0447861887514591, 0.0348809845745564, 0.0781513005495071, -0.0661181658506393, 0.1922686845064163, 0.0123756574466825, -0.0555355921387672, -0.7264227867126465, -0.0883365198969841, 0.1502417027950287, 0.0530591383576393, -0.0619559325277805},
        {-0.0269219055771828, -0.1489032059907913, 0.1716889888048172, 0.1680866181850433, 0.0771910101175308, 0.0617363303899765, 0.0724355727434158, 0.0094987563788891, 0.1191166490316391, 0.2080741524696350, 0.3147886097431183, 0.1019936203956604, 0.1656999140977859, 0.2193274497985840, 0.1019836217164993, 0.0503375120460987, -0.1726397871971130, 0.1373817175626755, -0.0728122815489769, -0.0619488731026649, 0.0649962350726128, 0.2100027799606323, -0.0293722376227379, -0.0999390184879303, 0.1446885913610458, -0.1047025918960571, 0.0833373367786407, -0.6750817894935608, -0.0289395134896040, -0.0169867090880871, 0.0301216281950474, 0.0361697562038898},
        {0.1922967880964279, -0.7704945802688599, -1.2521449327468872, 0.0146280266344547, 0.2429344654083252, 0.3544328510761261, -0.1682935208082199, -1.6147605180740356, 0.2451616227626801, -0.6504811048507690, 0.1489722728729248, 0.2123663425445557, 0.0384265109896660, 0.3083574473857880, -1.2666126489639282, -1.3481721878051758, -0.9284759163856506, 0.0617079660296440, 0.1326186060905457, 0.0418813154101372, -0.7478686571121216, 0.1365605890750885, 0.2526859939098358, 0.1955215036869049, -0.9657517671585083, -1.0300788879394531, 0.2980557084083557, -0.4608410000801086, 0.2144105136394501, -0.8803643584251404, -0.3854793906211853, -0.8801189661026001},
        {0.2528548836708069, 0.0800820812582970, 0.0933234170079231, 0.0765189006924629, 0.2487407773733139, 0.2607948184013367, -0.0941130146384239, 0.0155342137441039, 0.0550131872296333, 0.0126710124313831, 0.0945216268301010, -0.1316472887992859, -0.0107259787619114, 0.1891834735870361, -0.0614993646740913, 0.1308360844850540, 0.0912071019411087, -0.0988721027970314, -0.0357363261282444, -0.0694956928491592, 0.0296212788671255, 0.1656567156314850, 0.0611546039581299, 0.0921688079833984, 0.0154758747667074, -0.0052600321359932, 0.0700599402189255, -0.6903982758522034, 0.1614134311676025, -0.0428632088005543, 0.2237891554832458, 0.0879753753542900},
        {0.1019774973392487, 0.1491989642381668, 0.2292823940515518, 0.0967149883508682, 0.2532628178596497, 0.2688290774822235, -0.0768893361091614, 0.0210135374218225, 0.1157285347580910, -0.0283603332936764, 0.2416789233684540, -0.0206241924315691, 0.1659721583127975, 0.1439903974533081, 0.0349964946508408, -0.0279719997197390, 0.0295489300042391, 0.0808484628796577, 0.1165722757577896, 0.0804181247949600, 0.0890480875968933, 0.1852165013551712, -0.0717027857899666, -0.1397762745618820, 0.1970774829387665, 0.1316826194524765, -0.1865877211093903, -0.6613635420799255, -0.0680864900350571, -0.0416240468621254, 0.0850292220711708, -0.1209536492824554},
        {0.1115490123629570, 0.0582684949040413, 0.1817845851182938, -0.0307715535163879, 0.0674662292003632, 0.2136649042367935, 0.1296250969171524, -0.0089547252282500, 0.1158160418272018, 0.0151551077142358, 0.2112644463777542, 0.0864395350217819, 0.1143188178539276, 0.2389655709266663, -0.0452647358179092, -0.0808053761720657, -0.0046419622376561, -0.0081857871264219, -0.0273834541440010, -0.0308524519205093, -0.0443887375295162, 0.1289221644401550, -0.0137100452557206, -0.1092140823602676, 0.0988323092460632, 0.0049924715422094, 0.0650035440921783, -0.6886430978775024, -0.0915570333600044, 0.0290103927254677, 0.1360910236835480, -0.0559923723340034},
        {0.1745620369911194, 0.0126379719004035, 0.1118493229150772, -0.0866420567035675, 0.0979779586195946, 0.1338022500276566, -0.0297669507563114, 0.1651175469160080, 0.0418515913188457, 0.0896894559264183, 0.0764303952455521, 0.1656401157379150, 0.1812820285558701, 0.0348063521087170, -0.1040993258357048, -0.0820759236812592, 0.0433934405446053, 0.0950318500399590, -0.0113422870635986, 0.1292492747306824, -0.1980035454034805, 0.0299030374735594, 0.0664780735969543, -0.1111800670623779, 0.0744808390736580, 0.0597094036638737, -0.1102246195077896, -0.7185878157615662, 0.1403500735759735, 0.1977600753307343, -0.0631439611315727, 0.0087945405393839},
        {0.0993444249033928, -1.0008389949798584, -0.0868106037378311, -0.1958817541599274, -0.2132639735937119, -0.2932080626487732, -1.1414494514465332, 0.3548139929771423, 0.0564579665660858, -0.1460064798593521, -0.0798769965767860, -0.2070511281490326, -0.2689110934734344, -0.3511669635772705, 0.6246880888938904, 1.4566395282745361, -0.5928375124931335, -0.0214306805282831, 0.1242578327655792, -0.1945767402648926, -0.1019082367420197, -0.1986255496740341, -0.4073160290718079, -0.7440597414970398, -0.3792826831340790, 1.0024690628051758, -0.7654959559440613, 0.7196420431137085, -0.5782776474952698, 0.3408377170562744, 0.3137743175029755, 0.1334578990936279},
        {0.2978419661521912, -0.0847879424691200, 0.0789589956402779, 0.0917006134986877, 0.2878906428813934, 0.2891905307769775, 0.0496025197207928, 0.0548975989222527, 0.0541107133030891, 0.2700226306915283, 0.0502349324524403, -0.0428733453154564, 0.1022487208247185, 0.2753948569297791, 0.0631164386868477, -0.0516587682068348, 0.0650154128670692, 0.0893929451704025, 0.0652420297265053, 0.1035322323441505, -0.0324497632682323, 0.0112777519971132, -0.0282262749969959, -0.0659141242504120, 0.1298153847455978, 0.1399022936820984, 0.0478629469871521, -0.6983599662780762, -0.0194381698966026, 0.0295710042119026, 0.1219227313995361, 0.0006873059319332},
    };
    const float b2_1[32] = {
        0.1078331395983696, 0.5533669590950012, 0.4536709487438202, 0.5292487144470215, 0.5224621891975403, 0.5225009918212891, 0.4635325372219086, 0.5143399238586426, 0.4598598778247833, 0.5317386388778687, 0.3407036364078522, 0.3862942159175873, 0.6062454581260681, 0.5183760523796082, -0.9665248990058899, 0.5464529395103455, 0.5515092611312866, 0.3676449954509735, 0.4105545282363892, 0.3042851090431213, 0.5769758820533752, 0.5299755930900574, 0.5172784328460693, 0.4063462316989899, 0.4296848773956299, 0.1424325257539749, 0.3797473609447479, 0.4711440801620483, 0.4750762283802032, 0.6151755452156067, -0.6540696620941162, 0.3235805630683899
    };
    const float W3_1[32][32] = {
        {0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
        {-0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000001403, -0.0000000000000000, -0.0000000000000000, -0.0000000000000006, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000005, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000003, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000},
        {0.0000000008055173, -0.0000004745989770, 0.0000000000233288, -0.0000000019113935, -0.0000000270606808, -0.0000037494487515, -0.0000000000208450, 0.0000000000794714, -0.0000000001581746, -0.0001350473903585, 0.0000000037864401, -0.0000000004703940, -0.0000219851826841, 0.0000000002953640, 0.0000000000816894, -0.0000000006753162, -0.0000004623052803, -0.0000000011244532, -0.0000004850911637, 0.0000000050015037, 0.0000000048975428, -0.0000000011775129, -0.0000006720183023, 0.0000000005769992, -0.0000000458755700, -0.0000000014012890, 0.0000000003207218, 0.0000000051145279, 0.0000000003783546, -0.0000105803237602, 0.0000000010786306, -0.0000000009637449},
        {0.0001749054354150, -0.0009626227547415, -0.0003560883924365, 0.0004605758003891, -0.0012183081125841, -0.0028788133058697, 0.0010205474682152, 0.0010321764275432, -0.0001426028320566, -0.0068889404647052, -0.0023148006293923, -0.0025680067483336, -0.0022986629046500, 0.0001718850398902, 0.0000525092182215, -0.0009959725430235, -0.0017802005168051, -0.0017231486272067, -0.0052448292262852, -0.0008104649605229, -0.0001026072131936, -0.0020011945161968, -0.0004968904540874, 0.0001566392456880, -0.0029051697347313, -0.0000006769337233, 0.0006109026726335, -0.0030780686065555, -0.0021104032639414, -0.0000991236738628, -0.0002542724250816, -0.0014780517667532},
        {-0.0106793837621808, -0.0244571976363659, -0.0281809307634830, -0.0259807556867599, -0.0235411170870066, -0.0170418228954077, -0.0151626616716385, -0.0319176167249680, -0.0199276395142078, -0.0182267837226391, -0.0054159900173545, -0.0125256255269051, -0.0127278203144670, -0.0259279944002628, 0.0352766215801239, -0.0236752312630415, -0.0191018339246511, -0.0190073028206825, -0.0124016338959336, -0.0211435854434967, -0.0286325663328171, -0.0213493946939707, -0.0280354525893927, -0.0080094467848539, -0.0265770386904478, -0.0051726642996073, -0.0124883102253079, -0.0058648828417063, -0.0228142682462931, -0.0186462048441172, 0.0288094189018011, -0.0230831466615200},
        {0.8749033212661743, 0.3840857446193695, 1.0879186391830444, 0.2427467554807663, 0.1991239339113235, 0.1935704350471497, 0.0914104804396629, 0.2844308912754059, 0.4615604579448700, 0.2880385816097260, 0.1088816300034523, 0.2240664064884186, 0.1617421507835388, 0.5073955655097961, -0.6684243679046631, 0.2338206321001053, 0.2371567934751511, 0.0642288923263550, 0.2103139013051987, 0.0319224856793880, 0.1379500627517700, 0.2374513298273087, 0.0948691889643669, 0.2832171320915222, 0.2579373419284821, -1.3077679872512817, 0.2093112915754318, 0.2081791013479233, 0.2630370557308197, 0.2700264751911163, -0.5638968348503113, 0.0689934790134430},
        {0.9164058566093445, 0.3012216985225677, 1.0898479223251343, 0.1828059405088425, 0.0533904246985912, 0.2482147812843323, 0.1600378602743149, 0.2788163721561432, 0.4252119660377502, 0.2282033860683441, 0.1888794898986816, 0.1518727540969849, 0.0833029970526695, 0.4977281689643860, -0.4751189053058624, 0.2126259654760361, 0.2664030790328979, 0.3124229609966278, 0.2960849404335022, 0.2956404089927673, 0.0997185707092285, -0.0162076521664858, 0.2850465774536133, 0.0601457767188549, 0.2423550486564636, -1.2902755737304688, 0.1659711450338364, 0.1805839836597443, 0.0728101953864098, 0.2043623775243759, -0.3318398296833038, 0.3019693493843079},
        {0.9789894819259644, 0.1506747901439667, 1.1784361600875854, 0.1344080865383148, 0.1191041916608810, -0.0345735177397728, 0.2418302297592163, 0.3570228517055511, 0.4958469569683075, -0.0377202965319157, -0.0539524070918560, 0.0270419977605343, 0.0862359032034874, 0.4736800789833069, -1.2993828058242798, 0.2390811592340469, 0.0268247146159410, 0.0536352843046188, 0.0442026369273663, 0.1021365150809288, 0.2268978655338287, -0.0097813522443175, 0.2054729163646698, 0.1883468627929688, 0.1228749379515648, -1.3024876117706299, 0.0667539238929749, 0.1434718966484070, 0.1046422645449638, 0.0687503814697266, -1.3356240987777710, 0.1877074688673019},
        {0.9002243280410767, 0.1281707733869553, 1.1125586032867432, 0.2190057337284088, 0.0410262458026409, 0.1455952078104019, 0.1180427521467209, 0.5092996358871460, 0.5289944410324097, 0.1559694111347198, 0.0940930470824242, 0.2697338461875916, 0.2463696599006653, 0.5434198379516602, -0.7100940346717834, 0.2294444888830185, 0.2235796153545380, 0.1019755378365517, 0.0204746145755053, 0.1991457045078278, 0.1584600657224655, 0.1358328461647034, 0.1829161942005157, 0.2044156044721603, 0.1219367608428001, -1.3016772270202637, 0.2383295148611069, 0.1791323274374008, 0.2703147232532501, 0.1469715088605881, -0.7157048583030701, 0.1348987519741058},
        {-0.6683058738708496, 0.0399969480931759, -0.6728709340095520, 0.0013648455496877, 0.0063596889376640, 0.0094297742471099, 0.1295455694198608, -0.5058506131172180, -0.7070382237434387, 0.0656886100769043, 0.0008394569158554, 0.0552771240472794, 0.0697433948516846, -0.6324940323829651, -0.0612369365990162, 0.1190929412841797, 0.0689777433872223, 0.0053648678585887, -0.0102930720895529, -0.0902221500873566, 0.2442836761474609, -0.0180746298283339, 0.0894163474440575, -0.1038399040699005, 0.0453648380935192, 0.8847992420196533, 0.1172527298331261, -0.0638410896062851, -0.0031866275239736, 0.0777840241789818, -0.0466020703315735, -0.0224052760750055},
        {0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000011282, -0.0000000000000149, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000003, -0.0000000000000006, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000015, -0.0000000000000000, -0.0000000000000006, -0.0000000000000000, -0.0000000000000000, -0.0000000000000025, 0.0000000000000000, -0.0000000000000000},
        {0.9976214170455933, 0.0708504691720009, 1.1890050172805786, 0.1818239092826843, 0.2149712443351746, -0.0784592851996422, -0.0678458288311958, 0.3708552718162537, 0.5037081837654114, 0.0325505547225475, 0.1141868606209755, 0.1420107483863831, 0.1972672045230865, 0.5714709758758545, -1.2974134683609009, 0.1370974481105804, -0.0177578218281269, -0.0006687309942208, 0.0530201382935047, 0.1675166934728622, 0.1433323472738266, 0.0941354855895042, 0.1689768582582474, 0.1739251166582108, 0.0123207392171025, -1.2276842594146729, 0.0507287643849850, 0.0371460877358913, 0.0932704210281372, -0.0849969834089279, -1.4134377241134644, 0.0829631313681602},
        {-0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
        {0.9421581029891968, 0.2195088863372803, 1.0999444723129272, 0.2625017166137695, 0.2499881535768509, 0.0423511639237404, 0.2068859934806824, 0.2530190050601959, 0.4766401648521423, 0.0067737265489995, 0.0193532165139914, 0.1696709841489792, 0.3388608098030090, 0.4947769045829773, -0.6033717393875122, 0.0363704748451710, 0.0087787499651313, 0.2488340288400650, 0.2281343638896942, 0.2133141458034515, 0.2784207165241241, 0.1165082007646561, 0.2093729525804520, 0.1917800456285477, 0.0258109327405691, -1.2818456888198853, 0.1760946214199066, 0.2461442947387695, 0.2434947341680527, 0.1996725350618362, -0.5821294188499451, 0.2409460693597794},
        {0.9679243564605713, 0.1986243128776550, 1.0682433843612671, 0.2174060940742493, 0.2660496234893799, 0.2024438828229904, 0.1145357340574265, 0.4836136698722839, 0.4482789337635040, -0.0288884714245796, 0.0202737897634506, -0.0141315953806043, 0.0251898206770420, 0.4140489101409912, -1.2849786281585693, 0.0950320586562157, 0.1546388417482376, 0.2410555034875870, -0.0191738940775394, 0.0409868434071541, 0.1960660368204117, 0.1801486462354660, 0.1305120289325714, 0.2478879690170288, 0.1220381110906601, -1.3596084117889404, 0.0828910470008850, 0.1477963030338287, 0.1951590925455093, 0.0259607452899218, -1.3667907714843750, -0.0171807706356049},
        {-0.0000000295570661, -0.0004141798417550, -0.0000036405547235, -0.0007091402076185, -0.0005319475894794, -0.0022566041443497, -0.0002248576056445, 0.0000868057541084, 0.0000525428877154, -0.0009487726492807, 0.0003099508467130, -0.0012598752509803, -0.0003661914670374, 0.0001002048156806, -0.0007707370677963, -0.0007310697110370, -0.0002691859554034, -0.0027743894606829, -0.0011760180350393, -0.0007514146273024, -0.0014185798354447, -0.0008222671458498, -0.0003973802959081, -0.0008224291959777, -0.0037660684902221, 0.0000014396367760, -0.0000613579613855, -0.0007983530522324, -0.0003263260878157, -0.0001005314406939, 0.0007765500340611, -0.0025861291214824},
        {0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000},
        {0.9629969596862793, 0.1226738542318344, 1.1407128572463989, 0.2216149717569351, 0.3037775754928589, 0.1868114620447159, 0.1405746340751648, 0.4000930786132812, 0.4057498276233673, 0.2232523709535599, 0.1790093630552292, 0.2100853472948074, 0.2213246822357178, 0.4492484033107758, -0.6314606070518494, 0.2244777679443359, 0.1527964025735855, 0.0699675828218460, 0.1971501559019089, 0.1556710153818130, 0.0152586102485657, 0.2494123429059982, 0.2122682482004166, 0.0143887996673584, 0.1680724024772644, -1.3218455314636230, -0.0147586520761251, 0.0822983831167221, 0.1305309832096100, 0.0412539206445217, -0.3845856189727783, 0.0040219775401056},
        {0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000},
        {-0.3782635331153870, 0.0763091593980789, -0.6015332341194153, 0.0194474812597036, 0.0108788525685668, 0.0490707270801067, 0.0397340878844261, -0.3590119779109955, -0.4702029228210449, 0.0195662435144186, -0.0457338616251945, 0.0313084274530411, 0.0418745204806328, -0.4687889814376831, 0.2277297973632812, 0.1002940535545349, 0.0631145611405373, 0.0222501046955585, 0.0101933497935534, -0.0222255047410727, 0.1274660676717758, 0.0531475096940994, 0.0640188232064247, -0.0146620627492666, 0.0688989683985710, 0.6714718341827393, 0.0392170250415802, -0.0015642439248040, 0.0027454604860395, 0.0502320230007172, -0.2463659346103668, 0.0207587033510208},
        {0.9073628187179565, 0.2369277775287628, 1.1586346626281738, 0.2403769195079803, 0.1122962236404419, 0.2788265049457550, 0.1759524345397949, 0.4282688200473785, 0.4776014387607574, 0.0936206430196762, 0.1398985236883163, 0.1916741728782654, 0.2296776026487350, 0.4681820571422577, -0.4399973154067993, 0.1325349807739258, 0.1944741606712341, 0.0521288886666298, 0.2924371957778931, 0.2400009632110596, 0.2972882986068726, 0.2817690670490265, 0.2410373091697693, 0.1206584274768829, 0.0768484622240067, -1.3749536275863647, 0.2100940942764282, 0.0859752073884010, 0.2506124973297119, 0.1113422289490700, -0.2841505706310272, 0.0300625897943974},
        {0.9567812681198120, 0.0332985781133175, 1.1462600231170654, 0.1124021112918854, 0.3050402998924255, 0.2454900890588760, 0.1252193450927734, 0.3592617511749268, 0.4637978672981262, 0.0201823282986879, 0.1074161678552628, 0.1614011228084564, 0.2467827796936035, 0.5695844292640686, -1.0531007051467896, 0.1489254236221313, 0.2518846988677979, 0.1375506222248077, -0.0450401492416859, 0.0480184517800808, 0.1070073470473289, 0.1968895792961121, 0.1373205482959747, 0.2096699774265289, 0.1505176126956940, -1.2064366340637207, 0.0248477030545473, 0.0248968861997128, 0.1598281264305115, 0.1608878374099731, -1.0757317543029785, 0.0784033015370369},
        {0.9552325010299683, 0.2099007517099380, 1.0826160907745361, -0.0119667677208781, 0.2327304780483246, 0.0910882055759430, -0.0099121099337935, 0.1978044211864471, 0.4010322690010071, 0.2000208944082260, 0.2132764309644699, 0.2318721711635590, 0.0745041072368622, 0.3512977361679077, -0.7608169913291931, 0.1773625016212463, 0.0866167247295380, 0.1431798934936523, 0.2119673043489456, 0.1140065565705299, 0.1463620215654373, 0.2088411301374435, 0.0211597662419081, 0.2546205520629883, 0.0554269775748253, -1.3819271326065063, 0.1847160607576370, 0.2033444046974182, 0.0936063230037689, 0.2378789931535721, -0.7527207136154175, 0.1364207118749619},
        {-0.3957594037055969, 0.0279241856187582, -0.4998438954353333, -0.0055538606829941, -0.0061125606298447, 0.0218316931277514, 0.1334748715162277, -0.3792968094348907, -0.4959135949611664, 0.0426986403763294, 0.0017395672621205, 0.0477225631475449, 0.0248356461524963, -0.4768265485763550, -0.0904021635651588, 0.0641660168766975, 0.0134237408638000, 0.0058542070910335, 0.0070078438147902, -0.0334361456334591, 0.2238841801881790, -0.0549979880452156, 0.0608826130628586, -0.0786178410053253, 0.0240761786699295, 0.4328894019126892, 0.0907293334603310, -0.0680643394589424, -0.0260233301669359, 0.0721364095807076, -0.0305993705987930, -0.0345523208379745},
        {-0.0000000000000000, -0.0000000000026470, -0.0000000000000000, -0.0000000000016759, -0.0000000000473025, -0.0000000022642774, -0.0000000000382375, -0.0000000000000000, -0.0000000000000000, -0.0000000295652001, -0.0000000001120337, -0.0000000000014353, -0.0000000004319869, -0.0000000000000000, -0.0000000000000041, -0.0000000000966747, -0.0000000000123492, -0.0000000000190219, -0.0000000080315532, -0.0000000000083252, -0.0000000000002629, -0.0000000000158922, -0.0000000000144178, -0.0000000000092071, -0.0000000007263143, -0.0000000000000000, -0.0000000000086746, -0.0000000001984102, -0.0000000000000006, -0.0000000000004468, -0.0000000000000000, -0.0000000015069073},
        {0.7208416461944580, 0.2554369568824768, 0.9866308569908142, 0.2525717616081238, 0.1732949018478394, 0.1824453920125961, 0.2395739108324051, 0.4023276269435883, 0.4752543270587921, 0.2412310689687729, 0.1874274462461472, 0.1715329140424728, 0.2123160660266876, 0.4914503097534180, -0.1178762093186378, 0.2238199710845947, 0.1691910624504089, 0.2272887527942657, 0.2000409215688705, 0.1828523278236389, 0.2160570323467255, 0.1582487523555756, 0.1791870743036270, 0.2458697557449341, 0.1473216712474823, -0.8764688968658447, 0.1855796128511429, 0.2226701229810715, 0.2131111323833466, 0.2547445595264435, -0.0035235937684774, 0.1874439865350723},
        {-0.0000000062721526, -0.0000119462247312, 0.0000000004970553, -0.0000114165231935, -0.0000212751801882, -0.0000155429206643, 0.0000056547296481, 0.0000013359272089, 0.0000000350567895, 0.0001241202407982, -0.0001088366116164, 0.0000444154211436, -0.0000169288978213, 0.0000000197946868, -0.0000000111271072, -0.0000781414637459, -0.0000542734196642, -0.0000292562253890, -0.0000430048894486, -0.0001104285474867, -0.0000155839916260, -0.0000703694531694, -0.0000443254502898, 0.0000068137760536, -0.0000341756931448, -0.0000000082038527, -0.0000519466266269, -0.0000180507067853, -0.0000033596584217, -0.0000342239909514, -0.0000000057304703, -0.0000216523494601},
        {0.9608699083328247, 0.2767832577228546, 1.1395900249481201, 0.1087091714143753, 0.1032837927341461, 0.1320478767156601, -0.0197259485721588, 0.4741723537445068, 0.4537308514118195, -0.0314030088484287, 0.1363357752561569, 0.2025868743658066, 0.0845320746302605, 0.4102187752723694, -1.2420777082443237, 0.0218077916651964, 0.1717802435159683, 0.1941484957933426, -0.0554934963583946, -0.0511094778776169, 0.1922142803668976, 0.0719076842069626, 0.1599713563919067, 0.0700535550713539, 0.1532543152570724, -1.2962363958358765, 0.2263540327548981, 0.1573091298341751, 0.1608443707227707, 0.1098712980747223, -1.3233022689819336, -0.0175761394202709},
        {0.9269235134124756, 0.1513901352882385, 1.1269472837448120, 0.1118271723389626, 0.1624418348073959, 0.1156017705798149, 0.2782329022884369, 0.3225210011005402, 0.4508224427700043, 0.2832935154438019, 0.2726160585880280, 0.0079880645498633, 0.0559649206697941, 0.5205606222152710, -0.5110047459602356, 0.2000595331192017, 0.0054579610005021, 0.0732686370611191, 0.2152705788612366, 0.0656082853674889, 0.2398273497819901, 0.0577101446688175, 0.1670978963375092, 0.0722955465316772, 0.1934262663125992, -1.4105921983718872, 0.1051117032766342, 0.2889122962951660, 0.1241166740655899, 0.1127286329865456, -0.4346185028553009, 0.2417361140251160},
        {0.8991833329200745, 0.0936327874660492, 1.1535840034484863, 0.0513928979635239, 0.0041693877428770, 0.1316863596439362, 0.1414565742015839, 0.2994408905506134, 0.4900452494621277, 0.2516770660877228, 0.1602950841188431, 0.0233458094298840, 0.0329879596829414, 0.4111956655979156, -0.8237591981887817, 0.2758081853389740, 0.3069001138210297, 0.3095524311065674, 0.1571052819490433, 0.1888743042945862, 0.2661605775356293, 0.0991379469633102, 0.0328338555991650, 0.1169981434941292, 0.0022089465055615, -1.1830264329910278, 0.2748209834098816, 0.1827431023120880, 0.1243540942668915, 0.2011483460664749, -0.8552637100219727, 0.1792277544736862},
        {-0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000075, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000422, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000, -0.0000000000000003},
        {0.9111583828926086, 0.1175604909658432, 1.0475615262985229, 0.1399588733911514, 0.0001692823134363, 0.1603271812200546, 0.2564058899879456, 0.4284576475620270, 0.4515374600887299, 0.0704343616962433, 0.1310229301452637, 0.2186253070831299, 0.0559636801481247, 0.4192780852317810, -0.7187877297401428, 0.0616220906376839, 0.2302998304367065, 0.0215870719403028, 0.2135717421770096, 0.2466565817594528, 0.0845701545476913, 0.0824098214507103, 0.1686884909868240, 0.0660949647426605, 0.1607273370027542, -1.3937003612518311, -0.0145744308829308, 0.1503882259130478, 0.1306308507919312, 0.1459740251302719, -0.6486218571662903, 0.2200887054204941},
    };
    const float b3_1[32] = 
    {
        -0.0000000000000000, -0.0000000000000000, -0.0000000024308284, 0.0004699109704234, -0.0232136026024818, 1.0128800868988037, 1.0618014335632324, 1.0619763135910034, 1.1280590295791626, -0.3089008927345276, -0.0000000000000322, 0.9594467878341675, -0.0000000000000000, 1.0582753419876099, 0.9773048162460327, 0.0004207660967950, -0.0000000000000004, 1.1738952398300171, -0.0000000000000000, -0.5314493775367737, 1.1149603128433228, 1.1842677593231201, 1.1689238548278809, -0.0309564545750618, -0.0000000000010714, 1.1837258338928223, -0.0000025139077025, 1.0380929708480835, 1.0782891511917114, 0.9531439542770386, -0.0000000002017458, 1.1477710008621216
    };
    const float W4_1[32] = 
    {
        0.0000000000000000, -0.0017538205720484, 0.0008494071080349, -0.0123356450349092, -0.0306963287293911, 0.4321037232875824, 0.4328817725181580, 0.6832097172737122, 0.4585556089878082, -0.5677735805511475, 0.0151907457038760, 0.6784568428993225, -0.0000147212294905, 0.4853562116622925, 0.6270570158958435, -0.0033401537220925, -0.0000000000006140, 0.5333105325698853, -0.0000000000003353, -0.5806897282600403, 0.4652342200279236, 0.5685219168663025, 0.5533878803253174, -0.4250729680061340, -0.0073373951017857, 0.4233717322349548, -0.0046810330823064, 0.6743896007537842, 0.5192161798477173, 0.5234538912773132, 0.0062159220688045, 0.5568794012069702
    };
    const float b4_1 = 2.1590728759765625;

    float z1[HIDDEN_SIZE_1];
    
    // 第一层前向传播
    for (int i = 0; i < HIDDEN_SIZE_1; i++) 
    {
        z1[i] = 0;
        for (int j = 0; j < INPUT_SIZE; j++) {
            z1[i] += input_data[j] * W1_1[i][j];
        }
        z1[i] += b1_1[i];
    }
    relu(z1, z1, HIDDEN_SIZE_1);
    
    float z2[HIDDEN_SIZE_2];
    
    // 第二层前向传播
    for (int i = 0; i < HIDDEN_SIZE_2; i++) 
    {
        z2[i] = 0;
        for (int j = 0; j < HIDDEN_SIZE_1; j++) 
        {
            z2[i] += z1[j] * W2_1[i][j];
        }
        z2[i] += b2_1[i];
    }
    relu(z2, z2, HIDDEN_SIZE_2);
    
    float z3[HIDDEN_SIZE_3];
    
    // 第三层前向传播
    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        z3[i] = 0;
        for (int j = 0; j < HIDDEN_SIZE_2; j++) 
        {
            z3[i] += z2[j] * W3_1[i][j];
        }
        z3[i] += b3_1[i];
    }
    relu(z3, z3, HIDDEN_SIZE_3);
    // 输出层前向传播
    *output = 0;
    for (int i = 0; i < HIDDEN_SIZE_3; i++) 
    {
        *output += z3[i] * W4_1[i];
    }
    *output += b4_1;
}

void process_whisker(const float* input_data,
                     float* output) 
{
    float normalized_data[INPUT_SIZE];
    const float mean_1[3] = {54.20560548, -21.00775578, -14.01101664};
    const float std_1[3] = {18.14239061, 8.27251843, 11.67656998};
    normalization(input_data, mean_1, std_1, normalized_data);
    mlp_inference(normalized_data, output);
}

void dis_net(StateWhisker *statewhisker) 
{
    float input_data_1[INPUT_SIZE] = {statewhisker->whisker1_1, statewhisker->whisker1_2, statewhisker->whisker1_3};
    float input_data_2[INPUT_SIZE] = {statewhisker->whisker2_1, statewhisker->whisker2_2, statewhisker->whisker2_3};

    process_whisker(input_data_1, &statewhisker->mlpoutput_1);
    
    process_whisker(input_data_2, &statewhisker->mlpoutput_2);
}
